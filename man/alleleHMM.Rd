% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/callASCN.R
\name{alleleHMM}
\alias{alleleHMM}
\title{Run Viterbi HMM for allele-specific copy number inference}
\usage{
alleleHMM(
  n,
  x,
  binstates,
  minor_cn,
  loherror = 0.02,
  selftransitionprob = 0.999,
  eps = 1e-12,
  rho = 0,
  likelihood = "binomial"
)
}
\arguments{
\item{n}{Integer vector of total read counts per bin.}

\item{x}{Integer vector of B-allele read counts per bin.}

\item{binstates}{Integer vector of total copy number states per bin.}

\item{minor_cn}{Integer vector of possible minor allele copy number states.}

\item{loherror}{Sequencing error rate for LOH regions. Default 0.02.}

\item{selftransitionprob}{Self-transition probability in HMM. Default 0.999.}

\item{eps}{Small value for numerical stability. Default 1e-12.}

\item{rho}{Overdispersion for beta-binomial model. Default 0.0.}

\item{likelihood}{Likelihood model: "binomial" (default) or "betabinomial".}
}
\value{
A list with:
  * `minorcn`: Inferred minor allele copy number states
  * `l`: Matrix of log-likelihoods
}
\description{
Applies a Hidden Markov Model with Viterbi decoding to infer minor allele
copy number, considering both possible phasings (A|B and B|A) for each bin.
Unlike [HaplotypeHMM()], this function does not assume consistent phasing
within haplotype blocks.
}
\details{
This function considers both A|B and B|A configurations for each bin by
computing likelihoods for both x/n and (n-x)/n and taking the sum.
}
\seealso{
[HaplotypeHMM()] for phased version, [callAlleleSpecificCN()] for full pipeline
}
\keyword{internal}
