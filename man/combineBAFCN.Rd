% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/combinedata.R
\name{combineBAFCN}
\alias{combineBAFCN}
\title{Combine copy number bins with haplotype data}
\usage{
combineBAFCN(
  haplotypes,
  CNbins,
  filtern = 0,
  phased_haplotypes = NULL,
  minbins = 100,
  minbinschr = 10,
  phasing_method = "distribution",
  ...
)
}
\arguments{
\item{haplotypes}{A data.frame with haplotype allele counts. Required columns:
`cell_id`, `chr`, `start`, `end`, `hap_label`, `allele_id`, `readcount` (raw) or
`allele1`, `allele0`, `totalcounts` (formatted).}

\item{CNbins}{A data.frame with copy number bin data. Required columns:
`cell_id`, `chr`, `start`, `end`, `state`, `copy`.}

\item{filtern}{Minimum total read count per bin to include. Default 0.}

\item{phased_haplotypes}{Optional pre-computed phased haplotypes from
`computehaplotypecounts()`. If NULL, phasing is performed automatically.}

\item{minbins}{Minimum number of bins per cell to include. Default 100.}

\item{minbinschr}{Minimum number of bins per chromosome per cell. Default 10.}

\item{phasing_method}{Method for phasing haplotypes. One of "distribution" (default)
or use top N imbalanced cells.}

\item{...}{Additional arguments passed to `format_haplotypes()`.}
}
\value{
A data.frame with columns from CNbins plus:
  * `alleleA`: Read counts for A allele
  * `alleleB`: Read counts for B allele
  * `totalcounts`: Total read counts
  * `BAF`: B-allele frequency (alleleB / totalcounts)
}
\description{
Joins copy number bin data with phased haplotype counts to produce a combined
data.frame with copy number states and B-allele frequency (BAF) for each bin.
}
\examples{
data(CNbins)
data(haplotypes)
# Format haplotypes first
haps_formatted <- format_haplotypes_dlp(haplotypes, CNbins)
# Combine with CNbins
cnbaf <- combineBAFCN(haps_formatted, CNbins)

}
