% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/callHSCN.R
\name{HaplotypeHMM}
\alias{HaplotypeHMM}
\title{Run Viterbi HMM for haplotype-specific copy number inference}
\usage{
HaplotypeHMM(
  n,
  x,
  binstates,
  minor_cn,
  loherror = 0.02,
  selftransitionprob = 0.999,
  eps = 1e-12,
  likelihood = "binomial",
  rho = 0,
  Abias = 0,
  viterbiver = "cpp"
)
}
\arguments{
\item{n}{Integer vector of total read counts per bin (denominator for BAF).}

\item{x}{Integer vector of B-allele read counts per bin (numerator for BAF).}

\item{binstates}{Integer vector of total copy number states per bin.}

\item{minor_cn}{Integer vector of possible minor allele copy number states
(typically 0:maxCN).}

\item{loherror}{Sequencing error rate for LOH regions. Default 0.02.}

\item{selftransitionprob}{Self-transition probability in HMM. Higher values
produce smoother state calls. Default 0.999.}

\item{eps}{Small value added to likelihoods for numerical stability. Default 1e-12.}

\item{likelihood}{Likelihood model for emission probabilities. One of
"binomial" (default) or "betabinomial".}

\item{rho}{Overdispersion parameter for beta-binomial model. Only used when
likelihood = "betabinomial". Default 0.0.}

\item{Abias}{Bias towards A-allele states (for debugging). Default 0.0.}

\item{viterbiver}{Viterbi implementation to use. "cpp" (default) for C++
implementation, "R" for pure R (slower, for debugging).}
}
\value{
A list with two elements:
  * `minorcn`: Integer vector of inferred minor allele copy number states
  * `l`: Matrix of log-likelihoods (bins x states)
}
\description{
Applies a Hidden Markov Model with Viterbi decoding to infer the most likely
sequence of minor allele copy number states given observed B-allele frequencies.
}
\details{
The HMM uses binomial or beta-binomial emission probabilities based on
expected BAF for each state. States where minor CN > total CN / 2 are
forbidden (zero probability).
}
\seealso{
[assignHaplotypeHMM()] for per-cell wrapper,
  [callHaplotypeSpecificCN()] for full pipeline
}
\keyword{internal}
