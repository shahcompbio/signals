% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/combinedata.R
\name{format_haplotypes}
\alias{format_haplotypes}
\title{Format and phase haplotypes}
\usage{
format_haplotypes(
  haplotypes,
  filtern = 0,
  hmmcopybinsize = 5e+05,
  phased_haplotypes = NULL,
  phasing_method = "distribution",
  ...
)
}
\arguments{
\item{haplotypes}{A data.frame with haplotype allele counts. Required columns:
`cell_id`, `chr`, `start`, `end`, `hap_label`, `allele1`, `allele0`, `totalcounts`.}

\item{filtern}{Minimum total read count per haplotype to include. Default 0.}

\item{hmmcopybinsize}{Bin size used by HMMcopy. Default 0.5e6 (500kb).}

\item{phased_haplotypes}{Optional pre-computed phasing from `computehaplotypecounts()`.
If NULL, phasing is computed automatically using `phasing_method`.}

\item{phasing_method}{Method for phasing. "distribution" (default) uses the
distribution across all cells. Alternative is to use top N imbalanced cells
via `computehaplotypecounts()`.}

\item{...}{Additional arguments passed to `computehaplotypecounts()` if
`phasing_method` is not "distribution".}
}
\value{
A data.frame with phased haplotypes containing:
  * `alleleA`: Read counts for the dominant allele
  * `alleleB`: Read counts for the minor allele
  * `BAF`: B-allele frequency (alleleB / totalcounts)
}
\description{
Adds phasing information to formatted haplotypes, determining which allele
is the "A" (dominant) allele and which is the "B" (minor) allele for each
haplotype block.
}
\seealso{
[format_haplotypes_dlp()] for initial formatting,
  [phase_haplotypes()] and [computehaplotypecounts()] for phasing methods
}
